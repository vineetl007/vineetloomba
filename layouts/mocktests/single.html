{{ define "main" }}
<div class="container mx-auto px-4 py-6">
  <h1 class="text-2xl mb-4">{{ .Title }}</h1>

  {{ $mock := .Params }}
  <div id="mocktest-app" class="min-h-[400px]"></div>

  <script type="application/json" id="mocktest-data">
[
  {{- $subjects := slice "maths" "physics" "chemistry" -}}
  {{- range $sIndex, $sub := $subjects -}}
    {{- $qList := index $mock (printf "%s_questions" $sub) -}}
    {{- if $qList }}
      {{- range $i, $qPath := $qList -}}
        {{- $qPage := site.GetPage $qPath -}}
        {{- if $qPage }}
        {
          "id": {{ add (mul $sIndex 1000) $i }},
          "subject": "{{ $sub }}",
          "title": "{{ $qPage.Title | safeJS }}",
          "question": {{ $qPage.Params.question | jsonify }},
          "options": {{ $qPage.Params.options | jsonify }},
          "correctIndices": {{ $qPage.Params.correctIndices | jsonify }},
          "solution": {{ $qPage.Params.solution | jsonify }},
          "question_type": "{{ $qPage.Params.question_type }}",
          "numerical_answer": {{ $qPage.Params.numerical_answer | jsonify }},
          "difficulty": {{ if $qPage.Params.difficulty }}"{{ $qPage.Params.difficulty | safeJS }}"{{ else }}""{{ end }},
          "tags": {{ if $qPage.Params.tags }}{{ $qPage.Params.tags | jsonify }}{{ else }}[]{{ end }},
          "video_url": {{ if $qPage.Params.video }}"https://www.youtube.com/embed/{{ $qPage.Params.video }}?start={{ $qPage.Params.start_time | default 0 }}&rel=0"{{ else }}""{{ end }}
        }{{ if not (and (eq $sIndex (sub (len $subjects) 1)) (eq $i (sub (len $qList) 1))) }},{{ end }}
        {{- else }}
        // No question found at path: {{ $qPath }}
        {{- end }}
      {{- end }}
    {{- end }}
  {{- end }}
]
</script>

<script src="/js/mocktest.js"></script>

<div class="mt-6">
  <a href="/mocktests/"
     class="inline-block bg-blue-500 text-white font-concert py-2 px-4 rounded hover:bg-blue-400 transition">
    â¬… Back to Mock Tests
  </a>
</div>

</div>
{{ end }}
