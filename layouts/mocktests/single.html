{{ define "main" }}
<div class="container mx-auto px-4 py-6">
  <h1 class="text-2xl mb-4">{{ .Title }}</h1>

  {{/* Collect all paths from this mock test */}}
  {{ $qPaths := slice }}
  {{ range .Params.maths_questions }}{{ $qPaths = $qPaths | append . }}{{ end }}
  {{ range .Params.physics_questions }}{{ $qPaths = $qPaths | append . }}{{ end }}
  {{ range .Params.chemistry_questions }}{{ $qPaths = $qPaths | append . }}{{ end }}

  {{ $mockQs := slice }}

  {{/* Load each question by its relative path */}}
  {{ range $path := $qPaths }}
    {{ $q := site.GetPage $path }}
    {{ if $q }}
      {{ $mockQs = $mockQs | append $q }}
    {{ end }}
  {{ end }}

  {{ if gt (len $mockQs) 0 }}
<div id="mocktest-app" class="min-h-[400px]">
  <!-- subject tabs -->
  <div id="sections" class="flex gap-2 mb-4"></div>

  <!-- timer -->
  <div id="timer" class="mb-4 text-yellow-400 font-bold"></div>

  <!-- question display -->
  <div id="question-container" class="mb-4"></div>

  <!-- navigation palette -->
  <div id="nav" class="mb-4"></div>

  <!-- submit button -->
  <button id="submit-test" class="bg-green-600 text-white px-4 py-2 rounded">
    Submit Test
  </button>
</div>


<script type="application/json" id="mocktest-data">
{
  "maths": [
    {{ range $i, $path := .Params.maths_questions }}
      {{- if $i }},{{ end -}}
      {{ with site.GetPage $path }}
        {
          "File": { "Path": "{{ .File.Path }}" },
          "RelPermalink": "{{ .RelPermalink }}",
          "HTML": {{ .Content | safeJS }},
          "Params": {{ .Params | jsonify }}
        }
      {{ end }}
    {{ end }}
  ],
  "physics": [
    {{ range $i, $path := .Params.physics_questions }}
      {{- if $i }},{{ end -}}
      {{ with site.GetPage $path }}
        {
          "File": { "Path": "{{ .File.Path }}" },
          "RelPermalink": "{{ .RelPermalink }}",
          "HTML": {{ .Content | safeJS }},
          "Params": {{ .Params | jsonify }}
        }
      {{ end }}
    {{ end }}
  ],
  "chemistry": [
    {{ range $i, $path := .Params.chemistry_questions }}
      {{- if $i }},{{ end -}}
      {{ with site.GetPage $path }}
        {
          "File": { "Path": "{{ .File.Path }}" },
          "RelPermalink": "{{ .RelPermalink }}",
          "HTML": {{ .Content | safeJS }},
          "Params": {{ .Params | jsonify }}
        }
      {{ end }}
    {{ end }}
  ]
}
</script>


  // Build qStore from allQuestions
</script>
function buildQStore() {
  const store = { maths: [], physics: [], chemistry: [] };

  window.allQuestions.forEach(q => {
    const path = q.File.Path.toLowerCase();
    if (path.includes("jee-math")) store.maths.push(q);
    else if (path.includes("jee-physics")) store.physics.push(q);
    else if (path.includes("jee-chemistry")) store.chemistry.push(q);
  });

  return store;
}

let qStore = buildQStore();
console.log("qStore built:", qStore);



  
<script type="application/json" id="mocktest-data">
{
  "maths": {{ jsonify .Params.maths_questions }},
  "physics": {{ jsonify .Params.physics_questions }},
  "chemistry": {{ jsonify .Params.chemistry_questions }},
  "rank_preset": {{ jsonify .Params.rank_preset }}
}
</script>


    <script src="/js/mocktest.js"></script>

  {{ else }}
    <p>No questions found for this mock test.</p>
  {{ end }}

  {{/* Back to Mock Tests button */}}
  <div class="mt-6">
    <a href="/mocktest-bank/"
       class="inline-block bg-blue-500 text-white font-concert py-2 px-4 rounded hover:bg-blue-400 transition">
      â¬… Back to Mock Tests
    </a>
  </div>
</div>
{{ end }}
