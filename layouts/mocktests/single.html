{{ define "main" }}
<div class="container mx-auto px-4 py-6">
  <h1 class="text-2xl mb-4">{{ .Title }}</h1>

  <div id="mocktest-app" class="min-h-[400px]"></div>

  {{/* Collect all paths from this mock test */}}
  {{ $qPaths := slice }}
  {{ range .Params.maths_questions }}{{ $qPaths = $qPaths | append . }}{{ end }}
  {{ range .Params.physics_questions }}{{ $qPaths = $qPaths | append . }}{{ end }}
  {{ range .Params.chemistry_questions }}{{ $qPaths = $qPaths | append . }}{{ end }}

  {{/* Load each question by its relative path */}}
  {{ $mockQs := slice }}
  {{ range $path := $qPaths }}
    {{ $q := site.GetPage $path }}
    {{ if $q }}
      {{ $mockQs = $mockQs | append $q }}
    {{ end }}
  {{ end }}

  <script>
window.mockQuestions = [
  {{- range $i, $q := $mockQs -}}
  {
    id: {{ $i }},
    question: {{ $q.Params.question | jsonify }},
    options: {{ $q.Params.options | jsonify }},
    correctIndices: {{ $q.Params.correctIndices | jsonify }},
    solution: {{ $q.Params.solution | jsonify }},
    question_type: {{ $q.Params.question_type | jsonify }},
    numerical_answer: {{ $q.Params.numerical_answer | jsonify }},
    difficulty: {{ $q.Params.difficulty | jsonify }},
    tags: {{ $q.Params.tags | jsonify }},
    video_url: {{ if $q.Params.video }}"https://www.youtube.com/embed/{{ $q.Params.video }}?start={{ $q.Params.start_time | default 0 }}&rel=0"{{ else }}""{{ end }}
  }{{ if not (eq (add $i 1) (len $mockQs)) }},{{ end }}
  {{- end -}}
];
</script>

  <script src="/js/mocktest.js"></script>
</div>
{{ end }}
