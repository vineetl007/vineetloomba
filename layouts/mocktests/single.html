{{ define "main" }}
<div class="container mx-auto px-4 py-6">
  <h1 class="text-2xl mb-4">{{ .Title }}</h1>

  {{/* Collect all paths from this mock test */}}
  {{ $qPaths := slice }}
  {{ range .Params.maths_questions }}{{ $qPaths = $qPaths | append . }}{{ end }}
  {{ range .Params.physics_questions }}{{ $qPaths = $qPaths | append . }}{{ end }}
  {{ range .Params.chemistry_questions }}{{ $qPaths = $qPaths | append . }}{{ end }}

  {{ $mockQs := slice }}

  {{/* Load each question by its relative path */}}
  {{ range $path := $qPaths }}
    {{ $q := site.GetPage $path }}
    {{ if $q }}
      {{ $mockQs = $mockQs | append $q }}
    {{ end }}
  {{ end }}

  {{ if gt (len $mockQs) 0 }}
    <div id="mocktest-app" class="min-h-[400px]"></div>

    <script type="application/json" id="mocktest-data">
[
  {{- range $index, $q := $mockQs -}}
    {
      "id": {{ $index }},
      "question": "{{ $q.Params.question | safeJS }}",
      "options": [{{ range $i, $opt := $q.Params.options }}"{{ $opt | safeJS }}"{{ if not (eq (add $i 1) (len $q.Params.options)) }}, {{ end }}{{ end }}],
      "correctIndices": {{ $q.Params.correctIndices | jsonify }},
      "solution": "{{ $q.Params.solution | safeJS }}",
      "question_type": "{{ $q.Params.question_type }}",
      "numerical_answer": "{{ $q.Params.numerical_answer }}",
      "difficulty": {{ if $q.Params.difficulty }}"{{ $q.Params.difficulty | safeJS }}"{{ else }}""{{ end }},
      "tags": {{ if $q.Params.tags }}{{ $q.Params.tags | jsonify }}{{ else }}[]{{ end }},
      "video_url": {{ if $q.Params.video }}"https://www.youtube.com/embed/{{ $q.Params.video }}?start={{ $q.Params.start_time | default 0 }}&rel=0"{{ else }}""{{ end }}
    }{{ if not (eq (add $index 1) (len $mockQs)) }},{{ end }}
  {{- end -}}
]
    </script>

    <script src="/js/mocktest.js"></script>

  {{ else }}
    <p>No questions found for this mock test.</p>
  {{ end }}

  {{/* Back to Mock Tests button */}}
  <div class="mt-6">
    <a href="/mocktest-bank/"
       class="inline-block bg-blue-500 text-white font-concert py-2 px-4 rounded hover:bg-blue-400 transition">
      â¬… Back to Mock Tests
    </a>
  </div>
</div>
{{ end }}
