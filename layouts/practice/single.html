{{ define "main" }}

<div class="container mx-auto px-4 py-6">
  <h1 class="text-2xl mb-4">{{ .Title }}</h1>

  {{ $chapter := .Params.chapter }}
  {{ $dpp := .Params.dpp }}

  {{ $allQs := where .Site.RegularPages "Section" "questions" }}
  {{ $qsByChapter := where $allQs "Params.chapter" $chapter }}
  {{ $questions := where $qsByChapter "Params.dpp" $dpp }}

  {{ if gt (len $questions) 0 }}
    <div id="practice-app" class="min-h-[400px]"></div>

    <script type="application/json" id="practice-data">
[
  {{- range $index, $q := $questions -}}
    {
      "id": {{ $index }},
"question": "{{ $q.Params.question | safeJS }}",
     "options": [{{ range $i, $opt := $q.Params.options }}"{{ $opt | safeJS }}"{{ if not (eq (add $i 1) (len $q.Params.options)) }}, {{ end }}{{ end }}],
      "correctIndices": {{ $q.Params.correctIndices | jsonify }},
      "solution": "{{ $q.Params.solution | safeJS }}",
      "question_type": "{{ $q.Params.question_type }}",
      "numerical_answer": "{{ $q.Params.numerical_answer }}",
    "difficulty": {{ if $q.Params.difficulty }}"{{ $q.Params.difficulty | safeJS }}"{{ else }}""{{ end }},
 "tags": {{ if $q.Params.tags }}{{ $q.Params.tags | jsonify }}{{ else }}[]{{ end }},
      "video_url": {{ if $q.Params.video }}"https://www.youtube.com/embed/{{ $q.Params.video }}?start={{ $q.Params.start_time | default 0 }}&rel=0"{{ else }}""{{ end }}
    }{{ if not (eq (add $index 1) (len $questions)) }},{{ end }}
  {{- end -}}
]
</script>


    <script src="/js/practice.js"></script>

  {{ else }}
    <p>No questions found for this DPP.</p>
  {{ end }}

{{/* BACK TO QUESTION BANK BUTTON*/}}
<div class="mt-6">
  <a href="/question-bank/"
     class="inline-block bg-blue-500 text-white font-concert py-2 px-4 rounded hover:bg-blue-400 transition">
    â¬… Back to Question Bank
  </a>
</div>
  
{{/* Find the video lecture page for this chapter */}}
{{ $chapter := .Params.chapter }}
{{ $videoPage := site.GetPage (printf "/video-lectures/%s" $chapter) }}
{{ if $videoPage }}
  <div class="mt-10 p-4 bg-[#0D163D] rounded-xl shadow border border-gray-700">
    <h2 class="text-xl font-concert mb-2 flex items-center gap-2 text-[#ffb84d]">
      ðŸ“º Not Able to Solve Questions Confidently ? No Worries !!
    </h2>
    <p class="font-concert text-white mb-3">
      Watch the video lecture for <span class="font-concert text-white uppercase">{{ $chapter | title }}</span> to strengthen your concepts.
    </p>
    <a href="{{ $videoPage.RelPermalink }}" 
       class="inline-block bg-blue-500 text-white font-concert py-2 px-4 rounded-lg hover:bg-blue-400 transition">
       â–¶ Watch Now
    </a>
  </div>
{{ end }}


</div>

{{ end }}
