{{ define "main" }}
<div class="container mx-auto px-4 py-6">
  <h1 class="text-2xl font-bold mb-4">{{ .Title }}</h1>

  {{/* Get current chapter + dpp */}}
  {{ $chapter := .Params.chapter }}
  {{ $dpp := .Params.dpp }}

  {{/* Filter questions */}}
  {{ $allQs := where .Site.RegularPages "Section" "questions" }}
  {{ $qsByChapter := where $allQs "Params.chapter" $chapter }}
  {{ $questions := where $qsByChapter "Params.dpp" $dpp }}

  {{ if gt (len $questions) 0 }}
    <!-- App container -->
    <div id="practice-app"></div>

    <!-- Embed questions as JSON -->
    <script id="questions-data" type="application/json">
      [
        {{- range $i, $q := $questions -}}
          {
            "question": {{ $q.Params.question | jsonify }},
            "options": {{ $q.Params.options | jsonify }},
            "correctIndices": {{ $q.Params.correctIndices | jsonify }},
            "solution": {{ $q.Params.solution | jsonify }}
          }{{ if lt (add $i 1) (len $questions) }},{{ end }}
        {{- end -}}
      ]
    </script>

    <!-- Load practice logic -->
    <script src="/js/practice.js"></script>
  {{ else }}
    <p>No questions found for this DPP.</p>
  {{ end }}
</div>
{{ end }}
