{{ define "main" }}
<section class="max-w-5xl mx-auto px-6 py-8 text-white">

  <h1 class="text-3xl mb-6">Question Bank</h1>

  <div class="space-y-4">
    <!-- Maths collapsible -->
    <details class="bg-gray-900 rounded-lg shadow p-4">
      <summary class="cursor-pointer text-2xl font-bold">Maths</summary>

      {{ $maths := where .Site.RegularPages "Params.subject" "maths" }}

      {{/* collect unique chapters manually */}}
      {{ $chapters := slice }}
      {{ range $maths }}
        {{ if not (in $chapters .Params.chapter) }}
          {{ $chapters = $chapters | append .Params.chapter }}
        {{ end }}
      {{ end }}

      {{ range $chapters }}
        {{ $chapter := . }}
        <details class="bg-gray-800 rounded-lg p-3 mt-3 ml-4">
          <summary class="cursor-pointer text-xl font-semibold">{{ $chapter | title }}</summary>

   <div class="mt-2 ml-4 flex flex-wrap gap-2">
            {{/* collect unique dpps for this chapter */}}
            {{ $dpps := slice }}
            {{ range where $maths "Params.chapter" $chapter }}
              {{ if not (in $dpps .Params.dpp) }}
                {{ $dpps = $dpps | append .Params.dpp }}
              {{ end }}
            {{ end }}

            {{ range sort $dpps "value" "asc" }}
<a href="/practice/{{ $chapter | urlize }}-dpp-{{ . | urlize }}/"
      class="inline-block bg-blue-500 text-white font-concert py-2 px-4 rounded hover:bg-blue-400">
  {{ "DPP-" }}{{ replace . "dpp-" "" | upper }}
</a>
{{ end }}

          </div>
        </details>
      {{ end }}

    </details>
  </div>

</section>
{{ end }}
