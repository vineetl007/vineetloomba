{{ define "main" }}
<section class="max-w-5xl mx-auto px-6 py-8 text-white">

  <h1 class="text-3xl mb-6">Question Bank</h1>

  <div class="space-y-4">
    <!-- Maths collapsible -->
    <details class="bg-gray-900 rounded-lg shadow p-4">
      <summary class="cursor-pointer text-2xl font-bold">Maths</summary>

      {{/* Get all maths questions */}}
      {{ $questions := where .Site.RegularPages "Section" "questions" }}
      {{ $maths := where $questions "Params.subject" "maths" }}

      {{/* Collect all chapters */}}
      {{ $chapters := slice }}
      {{ range $maths }}
        {{ $chapters = $chapters | append .Params.chapter }}
      {{ end }}
      {{ $chapters = uniq (sort $chapters) }}

      <div class="mt-3 ml-4 space-y-3">
        {{ range $chapters }}
          {{ $chapter := . }}
          <details class="bg-gray-800 rounded-lg p-3">
            <summary class="cursor-pointer text-xl font-semibold">{{ $chapter }}</summary>

            <div class="mt-2 ml-4 space-y-2">
              {{ $qsByChapter := where $maths "Params.chapter" $chapter }}

              {{/* Collect all dpps for this chapter */}}
              {{ $dpps := slice }}
              {{ range $qsByChapter }}
                {{ $dpps = $dpps | append .Params.dpp }}
              {{ end }}
              {{ $dpps = uniq (sort $dpps) }}

              {{ range $dpps }}
                <a href="/practice/{{ $chapter | urlize }}/{{ . | urlize }}/"
                   class="block bg-yellow-400 text-black py-2 px-3 rounded hover:bg-yellow-300">
                   DPP {{ . }}
                </a>
              {{ end }}
            </div>
          </details>
        {{ end }}
      </div>
    </details>
  </div>

</section>
{{ end }}
