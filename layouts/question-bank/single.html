{{ define "main" }}
<div class="container mx-auto p-6">
  <h1 class="text-3xl font-bold mb-6">Question Bank</h1>

  <!-- MATHS -->
  <div class="mb-10">
    <h2 class="text-2xl font-semibold mb-4">Mathematics</h2>

    {{ $maths := where site.RegularPages "Section" "practice" | where ".Params.subject" "Maths" }}
    {{ $chapters := $maths | group "Params.chapter" }}

    {{ if gt (len $chapters) 0 }}
      {{ range $chapters }}
        <div class="mb-4 border rounded">
          <button class="w-full flex justify-between items-center px-4 py-2 font-medium bg-gray-100 hover:bg-gray-200 focus:outline-none chapter-toggle">
            <span>{{ .Key }}</span>
            <!-- Chevron -->
            <svg class="w-5 h-5 transition-transform duration-200 transform chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="chapter-content hidden px-4 py-2">
            <ul class="space-y-2 ml-2">
              {{ range .Pages }}
                <li>
                  <a href="{{ .RelPermalink }}" class="block p-2 border rounded hover:bg-gray-50">
                    {{ .Params.dpp }}
                  </a>
                </li>
              {{ end }}
            </ul>
          </div>
        </div>
      {{ end }}
    {{ else }}
      <p class="text-gray-500">No Maths DPPs added yet.</p>
    {{ end }}
  </div>

  <!-- PHYSICS -->
  <div class="mb-10">
    <h2 class="text-2xl font-semibold mb-4">Physics</h2>
    <p class="text-gray-500">Physics DPPs coming soon…</p>
  </div>

  <!-- CHEMISTRY -->
  <div class="mb-10">
    <h2 class="text-2xl font-semibold mb-4">Chemistry</h2>
    <p class="text-gray-500">Chemistry DPPs coming soon…</p>
  </div>
</div>

<script>
  // Accordion with chevron rotation
  document.addEventListener("DOMContentLoaded", () => {
    const toggles = document.querySelectorAll(".chapter-toggle");

    toggles.forEach(btn => {
      btn.addEventListener("click", () => {
        const content = btn.nextElementSibling;
        const chevron = btn.querySelector(".chevron");

        // Close all other chapters
        document.querySelectorAll(".chapter-content").forEach(div => {
          if (div !== content) div.classList.add("hidden");
        });

        document.querySelectorAll(".chevron").forEach(icon => {
          if (icon !== chevron) icon.classList.remove("rotate-180");
        });

        // Toggle clicked one
        content.classList.toggle("hidden");
        chevron.classList.toggle("rotate-180");
      });
    });
  });
</script>
{{ end }}
