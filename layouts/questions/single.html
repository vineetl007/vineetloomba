{{ define "main" }}
<section class="max-w-7xl mx-auto py-8 text-white">
<!--<div class="mx-auto px-1 sm:px-4 max-w-full sm:max-w-4xl border border-white rounded-xl p-6 sm:p-8 bg-gray-900">
<div class="mx-auto px-1 sm:px-10 max-w-full border border-white rounded-xl p-6 bg-[#0D163D]"> -->
  
  <div class="mx-auto max-w-full border border-white rounded-xl p-6 bg-[#0D163D]">
  <div class="px-2 sm:px-10">
  <link rel="canonical" href="{{ .RelPermalink }}" />

  <!-- Question Title 
<h1 class="text-3xl mb-6">{{ .Params.question | markdownify }}</h1> -->

  <!-- Difficulty & Tags --
 {{ with .Params.tags }}
<div class="mb-6 flex flex-wrap gap-2">
  {{ range . }}
    <a href="/tags/{{ . | urlize }}/" 
       class="bg-yellow-400 text-black font-concert text-sm px-3 py-1 rounded-full hover:bg-yellow-300 transition"> 
      {{ . }}
    </a>
  {{ end }}
</div>
{{ end }}

  {{ with .Params.difficulty }}
<div class="mb-6 flex flex-wrap gap-2">
  <a href="/difficulty/{{ . | urlize }}/" 
     class="bg-blue-500 text-white font-concert text-sm px-3 py-1 rounded-full hover:bg-blue-400 transition">
    Difficulty: {{ . }}
  </a>
</div>
{{ end }}

  <!-- Question Type --
{{ with .Params.question_type }}
<div class="mb-6 flex flex-wrap gap-2">
  <a href="/question-type/{{ . | urlize }}/" 
     class="bg-purple-500 text-white font-concert text-sm px-3 py-1 rounded-full hover:bg-purple-400 transition">
    Type: {{ . | title }}
  </a>
</div>
{{ end }}
  <!-- New through Partials   Difficulty & Tags ---->
  
  {{ partial "question-meta.html" . }}


  <!-- Question Content -->

 <div class="prose prose-invert mb-6 max-w-full">
   {{ .Params.question | markdownify }}
 </div>

<!-- Options -->
{{ if .Params.options }}
<div class="mb-6">
  <ul class="list-decimal list-inside space-y-2">
    {{ range $i, $opt := .Params.options }}
      {{ $isCorrect := in $.Params.correctIndices $i }}
      <li class="p-3 rounded-lg
                 {{ if $isCorrect }}bg-green-100 font-semibold text-green-800{{ end }}">
        {{ $opt | markdownify }}
        {{ if $isCorrect }} <span class="ml-2 text-green-600">✔️</span>{{ end }}
      </li>
    {{ end }}
  </ul>
</div>
{{ end }}




 <!-- Numerical Answer -->
 {{ with .Params.numerical_answer }}
 <div class="mb-6 bg-gray-800 p-4 rounded-lg">
   <strong>Numerical Answer:</strong> {{ . }}
 </div>
 {{ end }}

 <!-- Solution -->
 {{ with .Params.solution }}
 <div class="prose prose-invert mt-8">
   <h2 class="text-xl font-bold mb-3">Solution</h2>
   {{ . | markdownify }}
 </div>
 {{ end }}

<!-- Video Solution -->
{{ with .Params.video }}
  <div class="mt-8 flex justify-center">
    <div style="width:100%; max-width:720px; aspect-ratio:16/9; overflow:hidden; border-radius:12px;">
      <iframe
        src="https://www.youtube.com/embed/{{ . }}?start={{ $.Params.start_time | default 0 }}&rel=0"
        style="width:100%; height:100%; border:0; display:block;"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen
        referrerpolicy="strict-origin-when-cross-origin"
        title="Video Solution">
      </iframe>
    </div>
  </div>
{{ end }}




 <!-- JSON-LD Schema for QAPage with Question, Answer & optional Video -->
<script type="application/ld+json">
{{ $hasSolution := .Params.solution }}
{{ $hasVideo := .Params.video }}
{
  "@context": "https://schema.org",
  "@type": "QAPage",
  "mainEntity": {
    "@type": "Question",
    "url": {{ .Permalink | jsonify }},
    "name": {{ .Params.question | plainify | jsonify }},
    "text": {{ .Params.question | plainify | jsonify }},
    "datePublished": {{ .Date.Format `2006-01-02T15:04:05Z07:00` | jsonify }},
    "author": {
      "@type": "Person",
      "name": "Vineet Loomba"
    }{{ if $hasSolution }},
    "answerCount": 1,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": {{ .Params.solution | plainify | jsonify }},
      "datePublished": {{ .Date.Format `2006-01-02T15:04:05Z07:00` | jsonify }},
      "author": {
        "@type": "Person",
        "name": "Vineet Loomba"
      }{{ if $hasVideo }},
      "associatedMedia": {
        "@type": "VideoObject",
        "name": {{ printf "Video Solution for %s" (.Params.question | plainify) | jsonify }},
        "description": {{ printf "Video solution for %s" (.Params.question | plainify) | jsonify }},
        "thumbnailUrl": {{ printf "https://img.youtube.com/vi/%s/hqdefault.jpg" .Params.video | jsonify }},
  "uploadDate": "{{ with .Params.videoUploadDate }}{{ . }}{{ else }}{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}{{ end }}",
        "contentUrl": {{ printf "https://www.youtube.com/watch?v=%s" .Params.video | jsonify }},
        "embedUrl": {{ printf "https://www.youtube.com/embed/%s" .Params.video | jsonify }},
        "publisher": {
          "@type": "Organization",
          "name": "Vineet Loomba",
          "url": "https://vineetloomba.com",
          "logo": {
            "@type": "ImageObject",
            "url": "https://vineetloomba.com/images/logo.png"
          }
        }
      }{{ end }}
    }
    {{ end }}
  }
}
</script>

  </div>
</div>
</section>
{{ end }}
